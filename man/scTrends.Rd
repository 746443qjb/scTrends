% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scTrends.R
\name{scTrends}
\alias{scTrends}
\title{Classify gene expression trends along pseudotime}
\usage{
scTrends(
  scbin_result,
  min_cells = 4,
  peak_position_margin = 0.15,
  max_sign_changes_mono = 1,
  gam_k = 5,
  stable_cv_threshold = 0.15,
  stable_range_threshold = 0.12,
  stable_autocorr_threshold = 0.8,
  min_peak_prominence = 0.15,
  min_slope_ratio = 0.08,
  total_change_up = 0.15,
  total_change_down = -0.15,
  monotone_consistency = 0.7,
  min_sign_changes_complex = 3,
  complex_variance_threshold = 0.3,
  compute_pvalue = TRUE,
  n_perm = 1000,
  adjust_method = "BH",
  alpha = 0.05,
  n_cores = parallel::detectCores() - 2,
  use_parallel = TRUE,
  return_details = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{scbin_result}{An object of class \code{"scBin"} returned by \code{\link[=scBin]{scBin()}}.}

\item{min_cells}{Minimum number of valid bins required for classification.}

\item{peak_position_margin}{Fraction of bins excluded at the edges when
checking whether peak/valley lies in the “middle”.}

\item{max_sign_changes_mono}{Maximum number of sign changes in the
first derivative for a monotone classification.}

\item{gam_k}{Basis dimension \code{k} for the GAM smooth term.}

\item{stable_cv_threshold}{CV threshold for strict “Stable” classification.}

\item{stable_range_threshold}{Threshold on relative expression range
for “Stable” classification.}

\item{stable_autocorr_threshold}{Minimum lag-1 autocorrelation supporting
“Stable” classification.}

\item{min_peak_prominence}{Minimum normalized prominence for peak/valley
patterns.}

\item{min_slope_ratio}{Minimum normalized slope magnitude around peaks
and valleys.}

\item{total_change_up}{Minimum normalized net change to label a gene
as \code{"Up"}.}

\item{total_change_down}{Maximum normalized net change to label a gene
as \code{"Down"} (usually negative).}

\item{monotone_consistency}{Minimum monotonicity score
(fraction of steps in the same direction) for monotone trends.}

\item{min_sign_changes_complex}{Minimum number of sign changes to support
a \code{"Complex"} classification.}

\item{complex_variance_threshold}{Threshold on normalized residual variance
for \code{"Complex"} trends.}

\item{compute_pvalue}{Logical; if \code{TRUE}, perform permutation-based
significance testing per gene.}

\item{n_perm}{Number of permutations per gene when computing p-values.}

\item{adjust_method}{Method for multiple testing correction passed to
\code{\link[stats:p.adjust]{stats::p.adjust()}}, e.g. \code{"BH"} (default) or \code{"bonferroni"}.
Use \code{"none"} to skip adjustment.}

\item{alpha}{Significance level used to flag significant genes based on
adjusted q-values.}

\item{n_cores}{Number of cores to use for parallel computation.
Default uses \code{parallel::detectCores() - 2}.}

\item{use_parallel}{Logical; if \code{TRUE}, enable parallel classification.}

\item{return_details}{Logical; if \code{TRUE}, store per-gene diagnostics
in the output as well.}

\item{verbose}{Logical; if \code{TRUE}, print progress and summary information.}
}
\value{
An object of class \code{"scTrend"}, which is a list with components:
\describe{
\item{results}{Data frame with one row per gene and columns:
\code{gene}, \code{trend}, \code{p_value}, \code{q_value}, \code{significant}, plus optional
feature columns (if \code{return_details = TRUE}).}
\item{summary}{List with global statistics: number of genes, number
of bins, counts per trend category, and number of significant genes.}
\item{parameters}{List of parameter values used by the classifier.}
\item{detailed_results}{(Optional) Raw list of per-gene outputs from
the internal classifier, only if \code{return_details = TRUE}.}
}
}
\description{
\code{scTrends()} takes the bin-averaged expression matrix produced by
\code{\link[=scBin]{scBin()}} and classifies each gene into a temporal trend category
along pseudotime using a GAM-based, feature-rich classifier.

Each gene is assigned to one of:
\code{"Stable"}, \code{"Borderline_Stable"}, \code{"Up"}, \code{"Down"},
\code{"Up-Down"}, \code{"Down-Up"}, \code{"Complex"}, or \code{"Insufficient_Data"}.

Optionally, permutation-based p-values and FDR-adjusted q-values are
computed to assess the significance of the temporal pattern.
}
