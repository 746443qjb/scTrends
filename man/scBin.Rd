% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scBin.R
\name{scBin}
\alias{scBin}
\title{Bin single-cell pseudotime expression profiles}
\usage{
scBin(
  seurat_obj,
  pseudotime_col,
  assay = "RNA",
  slot = "data",
  n_bins = 40,
  overlap_ratio = 0,
  pseudotime_order = c("increasing", "decreasing"),
  x_range = c(0, 1),
  filter_genes = TRUE,
  max_zero_bins_pct = 0.5,
  min_expression = 0,
  min_cells_per_bin = 10,
  verbose = TRUE
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing the single-cell data.}

\item{pseudotime_col}{Character scalar. Name of the column in
\code{seurat_obj@meta.data} that stores pseudotime values.}

\item{assay}{Character scalar. Assay to use when extracting the
expression matrix. Default is \code{"RNA"}.}

\item{slot}{Character scalar. Slot to use when extracting the
expression matrix via \code{Seurat::GetAssayData()}. Common choices are
\code{"data"} (normalized) or \code{"counts"}. Default is \code{"data"}.}

\item{n_bins}{Integer. Number of bins along pseudotime. Default is 40.}

\item{overlap_ratio}{Numeric in [0, 1). If 0, bins are non-overlapping.
Values between 0 and 1 specify the overlap ratio for a sliding window
binning scheme (higher values = more overlap). Default is 0.}

\item{pseudotime_order}{Either \code{"increasing"} or \code{"decreasing"}.
Controls whether cells are ordered from low to high pseudotime or the
reverse. Default is \code{"increasing"}.}

\item{x_range}{Numeric vector of length 2 giving the x-axis range (e.g. 0 to 1).}

\item{filter_genes}{Logical. If \code{TRUE}, filter genes based on their
expression across bins (see \code{max_zero_bins_pct} and \code{min_expression}).
Default is \code{TRUE}.}

\item{max_zero_bins_pct}{Numeric between 0 and 1.
Maximum allowed proportion of bins with expression below \code{min_expression}.
Default is 0.5 (50\%).}

\item{min_expression}{Numeric. Minimum expression threshold used when
computing the proportion of zero/low bins per gene. Default is 0.}

\item{min_cells_per_bin}{Integer. Minimum number of cells allowed in a
bin. Bins with fewer cells trigger a warning. Default is 10.}

\item{verbose}{Logical. If \code{TRUE}, print progress messages. Default is
\code{TRUE}.}
}
\value{
A list of class \code{"scBin"} with components:
\itemize{
\item \code{bin_means}: A matrix of bin-averaged expression
(genes Ã— bins).
\item \code{x}: Numeric vector of pseudotime coordinates (length = \code{n_bins}).
\item \code{bin_info}: A data frame with per-bin statistics:
\code{bin_id}, \code{n_cells}, \code{pseudotime_median}, \code{pseudotime_mean},
\code{pseudotime_min}, \code{pseudotime_max}, \code{x_coord}.
\item \code{metadata}: A list of parameters and summary values used in the
binning procedure.
\item \code{cell_to_bin}: A data frame mapping each cell to a bin:
\code{cell}, \code{pseudotime}, \code{bin_id}.
\item \code{bin_to_cells}: A list where each element is an integer vector of
cell indices belonging to the corresponding bin.
\item \code{gene_filter_stats}: A data frame with per-gene filtering
information (\code{gene}, \code{n_zero_bins}, \code{zero_bins_pct}, \code{kept}),
or \code{NULL} if \code{filter_genes = FALSE}.
}
}
\description{
\code{scBin()} bins single-cell expression data along a pseudotime axis and
computes bin-averaged gene expression profiles. It supports both
non-overlapping and overlapping (sliding window) binning, and can
optionally filter lowly expressed genes across bins.
}
\details{
The function:
\enumerate{
\item Extracts pseudotime values from \code{seurat_obj@meta.data}.
\item Orders cells by pseudotime (increasing or decreasing).
\item Extracts the expression matrix from the specified assay and slot.
\item Bins cells into \code{n_bins} using either non-overlapping quantile-based
bins or a sliding window with \code{overlap_ratio}.
\item Computes bin-averaged expression for each gene.
\item Optionally filters genes based on their expression across bins.
\item Creates a pseudotime coordinate vector \code{x} over \code{x_range}.
\item Computes summary statistics of pseudotime within each bin.
}
}
\examples{
\dontrun{
  res <- scBin(
    seurat_obj = seurat_obj,
    pseudotime_col = "pseudotime",
    n_bins = 40,
    overlap_ratio = 0,
    pseudotime_order = "increasing"
  )

  str(res)
}
}
