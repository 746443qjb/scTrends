% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_trends.R
\name{plot_trends}
\alias{plot_trends}
\title{Plot gene expression trends along pseudotime}
\usage{
plot_trends(
  trend_result,
  bin_means,
  x,
  trend_type = "none",
  sig_metric = c("p_value", "q_value", "none"),
  max_genes = 30,
  sig_cutoff = 0.05,
  show_individual = TRUE,
  show_mean = TRUE,
  show_se = TRUE,
  individual_color = "gray60",
  individual_alpha = 0.3,
  individual_size = 0.5,
  mean_color = "darkblue",
  mean_size = 1.5,
  se_fill = "steelblue",
  se_alpha = 0.3,
  se_scale = 1.96
)
}
\arguments{
\item{trend_result}{Either:
\itemize{
\item an object of class \code{"scTrend"} produced by \code{\link[=scTrends]{scTrends()}}, or
\item a \code{data.frame} with at least the columns \code{gene}, \code{trend},
and optionally \code{p_value}, \code{q_value}.
}}

\item{bin_means}{A numeric matrix of bin-averaged expression values with
genes in rows and pseudotime bins in columns (e.g. \code{scbin_result$bin_means}).
Row names must match the \code{gene} column in \code{trend_result}.}

\item{x}{Numeric vector of pseudotime coordinates corresponding to
columns of \code{bin_means} (e.g. \code{scbin_result$x}).}

\item{trend_type}{Character scalar specifying which trend to plot.
Use \code{"none"} to ignore trend categories and include all selected genes.}

\item{sig_metric}{Significance metric to use for gene filtering.
One of \code{"p_value"}, \code{"q_value"}, or \code{"none"} (no significance filtering).}

\item{max_genes}{Integer. Maximum number of genes to plot after filtering.}

\item{sig_cutoff}{Numeric threshold for \code{p_value} or \code{q_value} when
\code{sig_metric != "none"}. Default is \code{0.05}.}

\item{show_individual}{Logical; if \code{TRUE}, plot individual gene trajectories.}

\item{show_mean}{Logical; if \code{TRUE}, overlay the mean trajectory across
selected genes.}

\item{show_se}{Logical; if \code{TRUE} and \code{show_mean = TRUE}, add a ribbon
representing mean ± \code{se_scale} × standard error.}

\item{individual_color}{Color for individual gene trajectories.}

\item{individual_alpha}{Alpha (transparency) for individual trajectories.}

\item{individual_size}{Line width for individual trajectories.}

\item{mean_color}{Color for the mean trajectory.}

\item{mean_size}{Line width for the mean trajectory.}

\item{se_fill}{Fill color for the standard error ribbon.}

\item{se_alpha}{Alpha (transparency) for the standard error ribbon.}

\item{se_scale}{Numeric multiplier for standard error (e.g. 1.96 ≈ 95\% band).}
}
\value{
A \code{ggplot} object that can be further customized with additional
\code{ggplot2} layers, themes, and labels.
}
\description{
\code{plot_trends()} visualizes gene expression trajectories along pseudotime
based on bin-averaged expression (e.g. from \code{\link[=scBin]{scBin()}}) and trend
classification results (e.g. from \code{\link[=scTrends]{scTrends()}}). It can:
\itemize{
\item filter genes by trend type (e.g. \code{"Up"}, \code{"Down"}, \code{"Complex"});
\item optionally filter by statistical significance (\code{p_value} or \code{q_value});
\item plot individual gene trajectories;
\item overlay the mean trajectory and an uncertainty band (standard error).
}

The function is designed to be style-agnostic: it returns a ggplot object
that can be further customized with user-defined themes, labels, etc.
}
\examples{
\dontrun{
  # Suppose you have:
  #   sb      <- scBin(seurat_obj, pseudotime_col = "pseudotime")
  #   trends  <- scTrends(sb)

  p <- plot_trends(
    trend_result = trends,          # or trends$results
    bin_means    = sb$bin_means,
    x            = sb$x,
    trend_type   = "Up",
    sig_metric   = "q_value",
    sig_cutoff   = 0.05,
    max_genes    = 50
  ) +
    ggplot2::labs(
      title = "Up-regulated genes",
      x = "Pseudotime",
      y = "Expression"
    ) +
    ggplot2::theme_minimal()

  print(p)
}

}
